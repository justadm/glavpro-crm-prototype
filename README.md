# Glavpro CRM прототип

Прототип CRM-воронки (стадии + события) для Joomla. Реализована карточка компании, логика стадий и базовое тестовое покрытие.

## Быстрый запуск
1. Установить Joomla 4/5.
2. Установить компонент из `/Users/just/Sites/главпро/component/com_glavpro_crm`.
3. Открыть админ-страницу компонента и список компаний.
4. Для демо-данных выполнить SQL из `/Users/just/Sites/главпро/component/com_glavpro_crm/administrator/components/com_glavpro_crm/sql/demo_seed.sql`.

## Архитектура
- Компонент Joomla с собственными таблицами `#__glavpro_companies` и `#__glavpro_crm_events`.
- Логика стадий через `StageEngine` и таблицу событий.
- Переходы между стадиями доступны только при наличии обязательных событий.

## Модель данных
- `#__glavpro_companies`: компания + текущая стадия.
- `#__glavpro_crm_events`: журнал событий компании.

## Логика стадий
- Стадии: Ice → Touched → Aware → Interested → demo_planned → Demo_done → Committed → Customer → Activated.
- Условия переходов и ограничения соответствуют требованиям ТЗ.

## Тесты
- Unit-тесты: `StageEngineTest`.
- Команды запуска: `composer install` и `vendor/bin/phpunit --configuration phpunit.xml`.

### Лог прогона
- Лог сохранен в `/Users/just/Sites/главпро/tests/test-log.txt`.

## AI-workflow
- Инструменты: указать используемые.
- Процесс: декомпозиция задач, проверка логики и результатов.
- Контроль рисков: сверка условий переходов и истории событий.
- Где AI дал выигрыш: тесты, шаблоны, документация.

## Улучшения
- Полная интеграция с UI Joomla (формы и права доступа).
- Роли менеджеров и разграничение действий.
- Больше интеграционных тестов.
